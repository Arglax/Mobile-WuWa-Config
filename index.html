<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WuWa Engine.ini Generator</title>
  <style>
    :root {
      color-scheme: dark;
    }

    /* ===== Base Styles ===== */
    body {
      font-family: "Segoe UI", Arial, sans-serif;

      /* üñºÔ∏è Background image ‚Äî replace the URL below with your GitHub-hosted image */
      background: url('assets/images/Background_1.jpg') center/cover no-repeat fixed;

      /* Example: background: url('images/myBackdrop.jpg') center/cover no-repeat fixed; */

      background-color: rgba(0, 0, 0, 0.8);
      background-blend-mode: darken;
      color: #eee;
      margin: 0;
      padding: 6rem 2rem 2rem; /* top padding to avoid navbar overlap */
    }

    h1 {
      text-align: center;
      color: #ffcc00;
      text-shadow: 0 0 10px #000;
    }

    /* ===== Top Navigation Bar ===== */
    .top-nav {
      position: fixed;
      top: 0;
      width: 100%;
      background: rgba(15, 15, 15, 0.9);
      border-bottom: 1px solid #333;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      padding: 0.8rem;
      z-index: 1000;
      backdrop-filter: blur(8px);
    }

    .top-nav a {
      text-decoration: none;
      color: #ffcc00;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      transition: all 0.2s ease-in-out;
    }

    .top-nav a:hover {
      color: #fff;
      transform: translateY(-2px);
    }

    /* ===== Panel (Group Box) ===== */
    details {
      background: rgba(20, 20, 20, 0.85);
      border: 1px solid #333;
      border-radius: 1rem;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
      max-width: 800px;
      margin: 2rem auto;
      padding: 1.5rem 2rem;
      backdrop-filter: blur(8px);
    }

    summary {
      font-weight: bold;
      color: #ffcc00;
      cursor: pointer;
      font-size: 1.2em;
      margin-bottom: 1rem;
    }

    summary:hover {
      text-shadow: 0 0 6px #ffcc0066;
    }

    /* ===== Controls ===== */
    input[type=range] {
      width: 100%;
      accent-color: #ffcc00;
    }

    .slider-labels {
      display: flex;
      justify-content: space-between;
      font-size: .9em;
      color: #aaa;
      margin-top: .2rem;
    }

    .button-row {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }

    button {
      background: #222;
      border: 1px solid #444;
      color: #ffcc00;
      padding: .6rem 1.2rem;
      border-radius: .4rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    button:hover {
      background: #333;
      border-color: #ffcc00;
      box-shadow: 0 0 10px #ffcc0033;
    }

    /* ===== Output Box ===== */
    pre {
      background: #0f0f0f;
      color: #00ff66;
      padding: 1rem;
      border-radius: .6rem;
      overflow-x: auto;
      font-size: 0.95em;
      white-space: pre-wrap;
      word-wrap: break-word;
      box-shadow: inset 0 0 10px #000;
    }

    /* ===== Floating Toolbar ===== */
    .utility-buttons {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      z-index: 999;
    }

    .utility-buttons button {
      background: rgba(30,30,30,0.8);
      border: 1px solid #555;
      color: #ffcc00;
      padding: .6rem 1rem;
      border-radius: .5rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .utility-buttons button:hover {
      background: rgba(50,50,50,0.9);
      border-color: #ffcc00;
    }

    /* ===== Mobile Layout ===== */
    @media (max-width: 768px) {
      body {
        padding: 6rem 1rem 1rem;
      }
      details {
        margin: 1rem;
        padding: 1rem;
      }
      .button-row {
        flex-direction: column;
        gap: 0.5rem;
      }
      button {
        width: 100%;
        font-size: 1rem;
      }
      pre {
        font-size: 0.85em;
      }
      .top-nav {
        flex-wrap: wrap;
        gap: 0.8rem;
      }
    }

    footer {
      text-align: center;
      font-size: 0.8em;
      color: #888;
      margin-top: 2rem;
    }
  </style>
</head>
<body>

  <!-- üåê Navigation Bar -->
  <nav class="top-nav">
    <a href="https://github.com/Arglax/Mobile-WuWa-Config/" target="_blank">üíæ GitHub Repos</a>
    <a href="https://arglax.github.io/Mobile-WuWa-Config/" target="_blank">üåê GitHub Page</a>
    <a href="https://discord.gg/renjxYBEZM" target="_blank">üí¨ Discord</a>
  </nav>

  <h1>WuWa Engine.ini Generator</h1>

  <!-- üéÆ Example Group Panel -->
  <details open>
    <summary>üéÆ Far-Distance Texture Quality Scaling</summary>
    <p>Adjust texture streaming and mipmap detail levels. 0 = lowest, 11 = ultra.</p>
    <p>You can actually go beyond these values (at your own risk lmao)</p>

    <div class="slider-section">
      <label for="slider"><b>Quality Scale</b></label>
      <input id="slider" type="range" min="0" max="11" value="5">
      <div class="slider-labels"><span>0</span><span>11</span></div>
    </div>

    <div class="button-row">
      <button id="dec">‚àí Decrease</button>
      <button id="reset">Reset</button>
      <button id="inc">+ Increase</button>
    </div>

    <h3>Generated Engine.ini Variables:</h3>
    <pre id="output"></pre>
  </details>

  <!-- üß≠ Floating Toolbar -->
  <div class="utility-buttons">
    <button onclick="collapseAll()">Collapse All</button>
    <button onclick="expandAll()">Expand All</button>
    <button onclick="window.scrollTo({top:0,behavior:'smooth'})">Back to Top</button>
  </div>

  <footer>Made by Arglax (GPT-assisted)</footer>

  <script>
  const slider = document.getElementById("slider");
  const output = document.getElementById("output");
  const decBtn = document.getElementById("dec");
  const incBtn = document.getElementById("inc");
  const resetBtn = document.getElementById("reset");

  // Non-linear scale function for smooth transitions
  function smoothScale(level, min, max, exponent = 1.3) {
    const t = Math.pow(level / 11, exponent);
    return (min + (max - min) * t);
  }

  // Function to generate commands dynamically
  function generateCommands(level) {
    // smoother scaling from 0‚Üí5.5 for Boost, 1‚Üí10 for GroupBoost
    const streamingBoost = smoothScale(level, 0, 5.5).toFixed(2);
    const groupBoost = smoothScale(level, 1, 10, 1.3).toFixed(2);

    // Predefined MipBias (piecewise)
    const mipBiasArray = [6, 4, 3, 2, 1, 0, -2, -4, -6, -8, -10, -12];
    const mipLODBias = mipBiasArray[level];

    return `
r.Streaming.GroupBoost.HugeBuildingTextureFactor=${groupBoost}
r.Streaming.GroupBoost.LargeBuildingTextureFactor=${groupBoost}
r.Streaming.GroupBoost.MediumBuildingTextureFactor=${groupBoost}
r.Streaming.GroupBoost.HugeFoliageTextureFactor=${groupBoost}
r.Streaming.GroupBoost.LargeFoliageTextureFactor=${groupBoost}
r.Streaming.GroupBoost.MediumFoliageTextureFactor=${groupBoost}
r.Streaming.GroupBoost.HugeNpcTextureFactor=${groupBoost}
r.Streaming.GroupBoost.LargeNpcTextureFactor=${groupBoost}
r.Streaming.GroupBoost.MediumNpcTextureFactor=${groupBoost}
r.Streaming.GroupBoost.CommonHLODTextureFactor=${groupBoost}
r.Streaming.GroupBoost.LandscapeHLODTextureFactor=${groupBoost}
r.Streaming.GroupBoost.LargeRocTextureFactor=${groupBoost}
r.Streaming.Boost=${streamingBoost}
r.Streaming.MinBoost=${streamingBoost}
r.Streaming.FullyLoadUsedTextures=1
r.MipMapLODBias=${mipLODBias}
r.Streaming.MipBias=-2
`.trim();
  }

  // Output update function
  function updateOutput() {
    output.textContent = generateCommands(+slider.value);
  }

  // Event listeners
  slider.addEventListener("input", updateOutput);
  decBtn.addEventListener("click", () => {
    slider.value = Math.max(0, +slider.value - 1);
    updateOutput();
  });
  incBtn.addEventListener("click", () => {
    slider.value = Math.min(11, +slider.value + 1);
    updateOutput();
  });
  resetBtn.addEventListener("click", () => {
    slider.value = 5;
    updateOutput();
  });

  // Initialize
  updateOutput();

  // ===== Collapse/Expand All Functions =====
  function collapseAll() {
    document.querySelectorAll('details').forEach(d => d.open = false);
  }
  function expandAll() {
    document.querySelectorAll('details').forEach(d => d.open = true);
  }
</script>


  ## üåë Shadows Settings

<details>
<summary><b>Click to expand Shadows Configuration</b></summary>

### üåì Shadows Quality

Select Mode:
<button onclick="setShadowMode('basic')">Basic</button>
<button onclick="setShadowMode('advanced')">Advanced</button>

<div id="shadowMode" style="margin-top:10px; font-weight:bold;">Current Mode: Basic</div>

---

### üîÜ Shadow Quality Scale (0‚Äì11)
<input type="range" min="0" max="11" value="5" id="shadowSlider" oninput="updateShadowQuality()">
<span id="shadowValue">5</span>

---

### ‚öôÔ∏è Generated Engine.ini (Shadows)
<textarea id="shadowOutput" style="width:100%; height:300px; margin-top:10px;" readonly></textarea>

---

<details>
<summary><b>üß† Technical Footnote ‚Äî Explanation of Shadow Settings</b></summary>

| Setting | Description |
|----------|--------------|
| `r.ShadowQuality` | Controls overall shadow rendering quality (0 = off, 5 = ultra). |
| `r.Shadow.CSM.MaxCascades` | Determines how many cascades are used for dynamic directional light shadows (higher = smoother distant shadows). |
| `r.Shadow.MinResolution` / `r.Shadow.MaxResolution` | Sets minimum and maximum shadow texture resolutions. |
| `r.Shadow.RadiusThreshold` | Controls how far small objects cast shadows. Lower = more detailed small-object shadows. |
| `r.Shadow.FarShadow` | Enables rendering of distant shadow cascades. |
| `r.ContactShadows` | Enables fine shadows directly under objects for realism. |
| `r.CapsuleShadows` | Enables capsule-based shadows for characters (soft contact shadows). |
| `r.DistanceFieldShadowing` | Enables distance field shadows for smoother, more realistic soft lighting. |

</details>

---

</details>

<script>
let shadowMode = "basic";

function setShadowMode(mode) {
  shadowMode = mode;
  document.getElementById("shadowMode").innerText = "Current Mode: " + mode.charAt(0).toUpperCase() + mode.slice(1);
  updateShadowQuality();
}

function updateShadowQuality() {
  const level = parseInt(document.getElementById("shadowSlider").value);
  document.getElementById("shadowValue").innerText = level;

  let output = "[SystemSettings]\n";

  // --- BASIC MODE ---
  if (shadowMode === "basic") {
    const quality = Math.min(Math.round((level / 11) * 5), 5);
    const minRes = 512 + Math.round((level / 11) * (2048 - 512));
    const maxRes = 1024 + Math.round((level / 11) * (4096 - 1024));
    const radius = (0.003 - (level / 11) * 0.002).toFixed(4);
    const radiusFar = (0.006 - (level / 11) * 0.003).toFixed(4);

    output += `r.ShadowQuality=${quality}\n`;
    output += `r.Shadow.MinResolution=${minRes}\n`;
    output += `r.Shadow.MaxResolution=${maxRes}\n`;
    output += `r.Shadow.RadiusThreshold=${radius}\n`;
    output += `r.Shadow.RadiusThresholdFar=${radiusFar}\n`;
    output += `r.Shadow.FarShadow=${level > 0 ? 1 : 0}\n`;
    output += `r.Shadow.CSM.MaxCascades=${Math.min(1 + Math.round(level / 3), 4)}\n`;

  // --- ADVANCED MODE ---
  } else {
    const quality = Math.min(Math.round((level / 11) * 5), 5);
    const cascades = Math.min(1 + Math.round(level / 3), 4);
    const distance = 50000 + Math.round((level / 11) * 2000000);
    const res = 1024 + Math.round((level / 11) * 3072);
    const radius = (0.003 - (level / 11) * 0.002).toFixed(4);
    const pcf = Math.min(1 + Math.round(level / 3), 3);
    const texelDensity = 2 + Math.round((level / 11) * 6);
    const fadeExp = (0.5 - (level / 11) * 0.25).toFixed(2);

    output += `
r.ShadowQuality=${quality}
r.Shadow.CSM.MaxCascades=${cascades}
r.Shadow.CSM.MaxDistance=${distance}
r.Shadow.FarShadowDistanceOverride=${distance}
r.Shadow.CSM0Distance=${Math.round(distance * 0.1)}
r.Shadow.CSM1Distance=${Math.round(distance * 0.3)}
r.Shadow.CSM2Distance=${Math.round(distance * 0.6)}
r.Shadow.CSM3Distance=${distance}
r.Shadow.DistributionExponent=1.15
r.Shadow.TransitionScale=2.0
r.Shadow.FadeExponent=${fadeExp}
r.Shadow.MinResolution=${res}
r.Shadow.MaxResolution=${res}
r.Shadow.MaxCSMResolution=${res}
r.Shadow.PerObjectShadowMapResolution=${res}
r.Shadow.PerObjectResolutionMax=${res}
r.Shadow.PerObjectResolutionMin=${Math.round(res / 2)}
r.Shadow.CSM0ShadowPCFQuality=${pcf}
r.Shadow.CSM1ShadowPCFQuality=${pcf}
r.Shadow.CSM2ShadowPCFQuality=${pcf}
r.Shadow.CSM3ShadowPCFQuality=${pcf}
r.Shadow.FilterMethod=1
r.Shadow.TexelsPerPixel=${texelDensity}
r.Shadow.PCFMaxSamples=${Math.round(16 + (level / 11) * 48)}
r.Shadow.TemporalFiltering=${level > 5 ? 1 : 0}
r.Shadow.FadeResolution=1
r.Shadow.CacheWholeSceneShadows=1
r.Shadow.FarShadow=${level > 0 ? 1 : 0}
r.Shadow.CachedShadowsCastFromMovablePrimitives=1
r.Shadow.EnableParallaxCorrection=${level > 8 ? 1 : 0}
r.Shadow.EnableParallaxCorrectionCrossFade=${level > 8 ? 1 : 0}
r.Shadow.RadiusThresholdOverrideEnable=1
r.Shadow.RadiusThreshold=${radius}
r.Shadow.RadiusThresholdFar=${(radius * 2).toFixed(4)}
r.ContactShadows=${level > 2 ? 1 : 0}
r.ContactShadowsStep=${Math.round(8 + (level / 11) * 56)}
r.ContactShadowsLength=${(5.0 + (level / 11) * 15).toFixed(1)}
r.ContactShadowsMinScreenPercent=0.01
r.CapsuleShadows=${level > 4 ? 1 : 0}
r.CapsuleMaxDirectOcclusionDistance=${Math.round(100 + (level / 11) * 300)}
r.CapsuleMinSkySpecularOcclusionDistance=30
r.CapsuleMaxSkySpecularOcclusionDistance=100
r.DistanceFieldShadowing=${level > 7 ? 1 : 0}
r.DistanceFieldShadowDistance=${Math.round(100000 + (level / 11) * 5000000)}
r.DistanceFieldShadowAccuracy=${(level / 11).toFixed(2)}
r.DistanceFieldShadowBias=${(0.1 - (level / 11) * 0.05).toFixed(3)}
r.DistanceFieldShadowPenumbraScale=${(0.5 + (level / 11) * 0.5).toFixed(2)}
r.DistanceFieldShadowNonDirectionalOffset=0.005
r.DistanceFieldShadowMinDistance=100.0
`.trim();
  }

  document.getElementById("shadowOutput").value = output;
}

updateShadowQuality();
</script>

</body>
</html>
